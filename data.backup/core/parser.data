#template {

    keyword [ { resolve [ resolve:keyword ] }
        [ [ #operator [ keyword ] ] [ #identifier keyword ] ]
    ]

    path [ { resolve [ resolve:path ] }
        [ [ #confirmed steps [ #template [ value ] ] [ #operator [ index ] ] ] ]
    ]

    list [ { resolve [ resolve:list ] }
        [ [ #operator [ open_square ] ] [ #list items [ #template [ value ] ] ] [ #operator [ close_square ] ] ]
        [ [ #operator [ open_square ] ] [ #data items [] ] [ #operator [ close_square ] ] ]
    ]

    map [ { resolve [ resolve:map ] }
        [ [ #operator [ open_curly ] ] [ #list entries [ #template [ value ] ] ] [ #operator [ close_curly ] ] ]
        [ [ #operator [ open_curly ] ] [ #data entries {} ] [ #operator [ close_curly ] ] ]
    ]

    boolean [ { resolve [ resolve:boolean ] }
        [ [ #operator [ boolean ] ] [ #identifier state [ true false ] ] ]
    ]

    value [ { resolve [ resolve:value ] }
        [ [ #template value [ map ] ] ]
        [ [ #template value [ path ] ] ]
        [ [ #template value [ list ] ] ]
        [ [ #identifier value ] ]
        [ [ #template value [ keyword ] ] ]
        [ [ #string value ] ]
        [ [ #character value ] ]
        [ [ #data negative $true ] [ #operator [ subtract ] ] [ #integer value ] ]
        [ [ #data negative $true ] [ #operator [ subtract ] ] [ #float value ] ]
        [ [ #data negative $false ] [ #integer value ] ]
        [ [ #data negative $false ] [ #float value ] ]
        [ [ #template value [ boolean ] ] ]
        [ [ #template value [ function ] ] ]
    ]

    parameter [ { resolve [ resolve:parameter ] }
        [ [ #data list $true ] [ #operator [ add ] ] [ #identifier identifier ] ]
        [ [ #data list $false ] [ #identifier identifier ] ]
    ]

    parameters [
        [ [ #operator [ open_round ] ] [ #list parameters [ #template [ parameter ] ] [ #operator [ comma ] ] ] [ #operator [ close_round ] ] ]
        [ [ #operator [ open_round ] ] [ #data parameters [ ] ] [ #operator [ close_round ] ] ]
    ]

    immediate [ { resolve [ resolve:immediate ] }
        [ [ #operator [ immediate ] ] [ #template immediate [ value ] ] ]
    ]

    absolute_path [ { resolve [ resolve:absolute_path ] }
        [ [ #operator [ and ] ] [ #template path [ value ] ] ]
    ]

    relative_path [ { resolve [ resolve:relative_path ] }
        [ [ #template path [ value ] ] ]
    ]

    index [ { resolve [ resolve:index ] }
        [ [ #template collection [ substitue_value ] ] [ #operator [ open_square ] ] [ #template index [ substitue_value ] ] [ #operator [ close_square ] ] ]
    ]

    instruction [ { resolve [ resolve:instruction ] }
        [ [ #identifier instruction ] [ #operator [ open_round ] ] [ #list parameters [ #template [ substitue_value ] ] [ #operator [ comma ] ] ] [ #operator [ close_round ] ] ]
        [ [ #identifier instruction ] [ #operator [ open_round ] ] [ #data parameters [ ] ] [ #operator [ close_round ] ] ]
    ]

    condition [ { resolve [ resolve:condition ] }
        [ [ #template condition [ keyword ] ] [ #operator [ open_round ] ] [ #list parameters [ #template [ substitue_value ] ] [ #operator [ comma ] ] ] [ #operator [ close_round ] ] ]
    ]

    comparison [ { resolve [ resolve:comparison ] }
        [ [ #template left [ substitue_value ] ] [ #merge [ comparitor ] ] [ #template right [ substitue_value ] ] ]
    ]

    logical_equasion [ { resolve [ resolve:logical_equasion ] }
        [ [ #confirmed values [ #template [ substitue_value ] ] [ #template [ logical_operator ] ] ] ]
    ]

    concatinate [ { resolve [ resolve:concatinate ] }
        [ [ #confirmed values [ #template [ substitue_value ] ] [ #operator [ concatinate ] ] ] ]
    ]

    substitue_value [ { resolve [ resolve:substitue_value ] }
        [ [ #template value [ immediate ] ] ]
        [ [ #template value [ absolute_path ] ] ]
        [ [ #template value [ relative_path ] ] ]
        [ [ #template value [ index ] ] ]
        [ [ #template value [ instruction ] ] ]
        [ [ #template value [ condition ] ] ]
        [ [ #template value [ comparison ] ] ]
        [ [ #template value [ logical_equasion ] ] ]
        [ [ #template value [ concatinate ] ] ]
        [ [ #operator [ open_round ] ] [ #template value [ substitue_value ] ] [ #operator [ close_round ] ] ]
    ]

    comparitor [
        [ [ #operator comparitor [ equals ] ] ]
        [ [ #operator comparitor [ not_equals ] ] ]
        [ [ #operator comparitor [ not_smaller ] ] ]
        [ [ #operator comparitor [ not_bigger ] ] ]
        [ [ #operator comparitor [ bigger ] ] ]
        [ [ #operator comparitor [ smaller ] ] ]
    ]

    logical_operator [
        [ [ #operator operator [ logical_and ] ] ]
        [ [ #operator operator [ logical_or ] ] ]
        [ [ #operator operator [ logical_xor ] ] ]
    ]

    set [ { resolve [ resolve:set ] }
        [ [ #identifier [ set ] ] [ #template path [ substitue_value ] ] [ #operator [ assign ] ] [ #template value [ substitue_value ] ] ]
    ]

    return [ { resolve [ resolve:return ] }
        [ [ #identifier [ return ] ] [ #template value [ substitue_value ] ] ]
        [ [ #identifier [ terminate ] ] ]
    ]

    if [ { resolve [ resolve:if ] }
        [ [ #identifier [ if ] ] [ #template condition [ substitue_value ] ] [ #merge [ scope ] ] [ #template else [ else ] ] ]
        [ [ #identifier [ if ] ] [ #template condition [ substitue_value ] ] [ #merge [ scope ] ] ]
    ]

    else [ { resolve [ resolve:else ] }
        [ [ #identifier [ else ] ] [ #template condition [ substitue_value ] ] [ #merge [ scope ] ] [ #template else [ else ] ] ]
        [ [ #identifier [ else ] ] [ #template condition [ substitue_value ] ] [ #merge [ scope ] ] ]
        [ [ #identifier [ else ] ] [ #merge [ scope ] ] [ #template else [ else ] ] ]
        [ [ #identifier [ else ] ] [ #merge [ scope ] ] ]
    ]

    while [ { resolve [ resolve:while ] }
        [ [ #identifier [ while ] ] [ #template condition [ substitue_value ] ] [ #merge [ scope ] ] ]
    ]

    ensure [ { resolve [ resolve:ensure ] }
        [ [ #identifier [ ensure ] ] [ #operator [ open_round ] ] [ #list parameters [ #template [ substitue_value ] ] [ #operator [ comma ] ] ] [ #operator [ close_round ] ] ]
    ]

    call [ { resolve [ resolve:call ] }
        [ [ #template instruction [ instruction ] ] ]
    ]

    iterate [ { resolve [ resolve:iterate ] }
        [ [ #identifier [ iterate ] ] [ #template collection [ substitue_value ] ] [ #identifier [ as ] ] [ #identifier key ] [ #operator [ comma ] ] [ #identifier value ] [ #merge [ scope ] ] ]
        [ [ #identifier [ iterate ] ] [ #template collection [ substitue_value ] ] [ #merge [ scope ] ] ]
    ]

    statement [ { resolve [ resolve:statement ] }
        [ [ #template statement [ set ] ] ]
        [ [ #template statement [ return ] ] ]
        [ [ #template statement [ if ] ] ]
        [ [ #template statement [ while ] ] ]
        [ [ #template statement [ ensure ] ] ]
        [ [ #template statement [ call ] ] ]
        [ [ #template statement [ iterate ] ] ]
    ]

    scope [
        [ [ #operator [ open_curly ] ] [ #list statements [ #template [ statement ] ] ] [ #operator [ close_curly ] ] ]
        [ [ #operator [ open_curly ] ] [ #data statements [] ] [ #operator [ close_curly ] ] ]
    ]

    function [ { resolve [ resolve:function ] }
        [ [ #identifier [ Function ] ] [ #merge [ parameters ] ] [ #merge [ scope ] ] ]
    ]

    #top [ { resolve [ resolve:#top ] }
        [ [ #list values [ #template [ value ] ] ] ]
        [                                          ]
    ]
}
